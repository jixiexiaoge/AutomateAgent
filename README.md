# Power Automate Desktop 命令输入工具

这个项目提供了一系列工具，用于在 Power Automate Desktop (PAD) 中输入命令。

## 作者信息

- **作者**：机械小鸽
- **微软MVP**
- **知识星球**：微软PowerPlatform
- **地址**：[https://public.zsxq.com/groups/15522844582412.html](https://public.zsxq.com/groups/15522844582412.html)

## 主要工具

### 1. 剪贴板输入工具 (pad_clipboard_input.py)

这个工具使用**复制和粘贴**方式向 PAD 中输入命令，是目前推荐的主要工具。

功能特点：
- 通过剪贴板操作，兼容 PAD 的粘贴功能
- 支持自动定位或手动定位编辑区域
- 提供常用命令预设
- 带有友好的图形界面
- **AI转换功能**：将自然语言需求转换为PAD命令

### 2. 鼠标位置追踪器 (mouse_position_tracker.py)

帮助找到 PAD 中正确的点击位置的辅助工具。

### 3. UI 调试工具 (ui_spy_tool.py)

高级调试工具，用于分析 PAD 的 UI 结构。

## 安装依赖项

```
pip install -r requirements.txt
```

## 使用方法

### 剪贴板输入工具使用方法

1. 运行工具：
   ```
   python pad_clipboard_input.py
   ```

2. 工具提供两种模式：
   - **标准模式**：直接输入PAD命令
   - **AI转换模式**：使用自然语言描述需求，自动转换为PAD命令

3. 标准模式使用步骤：
   - 输入要粘贴的命令或从预设中选择
   - 选择点击方式
   - 点击"执行复制粘贴"按钮

4. AI转换模式使用步骤：
   - 确保已输入有效的Gemini API密钥
   - 用自然语言描述您的自动化需求
   - 点击"转换为PAD命令"按钮
   - 检查和调整生成的命令（系统会自动过滤不正确的命令）
   - 点击"一键执行"按钮（包含转换、启动PAD和执行命令的全流程）

5. 选择点击方式：
   - **自动查找编辑区**：工具会尝试自动定位 PAD 的编辑区域
   - **使用鼠标当前位置**：先用"记录鼠标位置"按钮记录位置，然后使用该位置

### 使用提示

1. **先确保 PAD 已打开**，并处于可以接受命令输入的状态

2. 如果自动定位不准确，使用以下步骤：
   - 点击"记录鼠标位置(5秒)"按钮
   - 在 5 秒倒计时期间，将鼠标移动到 PAD 编辑区
   - 选择"使用鼠标当前位置"选项
   - 点击"执行复制粘贴"按钮

3. 调整"点击后延迟"参数，如果 PAD 响应较慢，可以增加延迟时间

4. 使用AI转换时的技巧：
   - 描述需要尽量具体、清晰
   - 对于复杂任务，尝试分解为多个简单步骤
   - 如果生成的命令不满意，可以调整自然语言描述后重试

## AI转换功能说明

AI转换功能使用Google Gemini API将自然语言描述转换为PAD的Robin语言命令。该功能：

1. 自动过滤不正确的命令，确保只保留有效命令
2. 支持一键启动PAD并执行生成的命令
3. 针对Power Automate Desktop的Robin语法进行了优化

示例需求描述：
- "每3秒钟在记事本中输入当前时间"
- "打开Edge浏览器访问百度并搜索Power Automate"
- "监控指定文件夹，发现新文件时发送邮件通知"

## 常见问题解决

- **找不到 PAD 窗口**：确保 PAD 已打开并且窗口标题包含"Power Automate"
- **粘贴无效**：确保点击了正确的编辑区域，尝试使用鼠标位置记录功能
- **命令无法执行**：检查 PAD 是否处于可以接受命令的状态，可能需要先创建或打开一个流
- **生成的命令不正确**：AI转换功能会尽力生成正确的命令，但可能不完美。尝试调整您的需求描述，使其更具体或简化
- **启动PAD失败**：检查PAD安装路径是否正确，默认路径是"C:\Program Files (x86)\Power Automate Desktop\PAD.exe"
- **API调用失败**：确保已输入正确的API密钥和网络连接正常
- **多余的错误命令**：工具会自动过滤掉无效命令，如果仍有问题，尝试手动编辑生成的命令
- **点击位置不准确**：PAD界面可能随版本变化，使用"记录鼠标位置"功能指定准确位置

## 高级用法

### 自定义预设命令

工具已内置一些常用命令，您也可以编辑源代码添加自己的预设：

1. 打开`pad_clipboard_input.py`
2. 找到`self.preset_commands`列表
3. 添加您常用的PAD命令

### 调整命令验证规则

如果工具错误地过滤了有效命令，您可以修改验证规则：

1. 编辑`clean_pad_commands`方法中的`valid_prefixes`列表
2. 添加您使用的PAD命令前缀

## 更新日志

### v1.2.0
- 添加AI转换功能，支持将自然语言转换为PAD命令
- 增加命令验证机制，自动过滤无效命令
- 支持一键执行（转换+启动+执行）流程

### v1.1.0
- 优化UI界面，增加多行文本输入
- 添加预设命令功能
- 改进日志记录

### v1.0.0
- 初始版本发布 

---

© 2023-2024 机械小鸽 | 微软MVP | [微软PowerPlatform知识星球](https://public.zsxq.com/groups/15522844582412.html) 
